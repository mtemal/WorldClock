<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CSO Clocks</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;margin:20px;background:#f4f4f4}
  h2{margin:12px 0 6px}
  .clock{background:#fff;border-radius:6px;padding:12px;margin-bottom:16px;
         box-shadow:0 1px 3px rgba(0,0,0,.15)}
  .clock h3{margin:0 0 4px;font-size:1.1rem}
  .time{font-size:1.6rem;font-weight:600}
  .controls{margin-top:8px}
  input[type="number"],input[type="text"],input[type="datetime-local"]{
    padding:4px 6px;font-size:0.9rem;margin-right:6px;width:140px}
  button{padding:5px 10px;font-size:0.9rem;background:#2d89ef;color:#fff;border:none;border-radius:4px}
  button:hover{background:#1b5fbd}
</style>
</head>
<body>

<h1>CSO Clocks</h1>

<!-- 1️⃣ EST Clock -->
<div class="clock" id="clock-est">
  <h3> Washington D.C.</h3>
  <div class="time" id="time-est">--:--:--</div>
</div>

<!-- 2️⃣ Custom Clock 1 -->
<div class="clock" id="clock-c1">
  <h3> Origin Time </h3>
  <div class="time" id="time-c1">--:--:--</div>
  <div class="controls">
    <input type="text" id="offset-c1" placeholder="+5.5 or -3">
    <button id="set-c1">Set</button>
  </div>
</div>

<!-- 3️⃣ Custom Clock 2 -->
<div class="clock" id="clock-c2">
  <h3>Destination Time</h3>
  <div class="time" id="time-c2">--:--:--</div>
  <div class="controls">
    <input type="text" id="offset-c2" placeholder="+2 or -8.5">
    <button id="set-c2">Set</button>
  </div>
</div>

<!-- 4️⃣ Countdown -->
<div class="clock" id="countdown">
  <h3>ETA</h3>
  <div class="time" id="time-remaining">--:--:--</div>
  <div class="controls">
    <input type="datetime-local" id="target-dt">
    <button id="start-cd">Start</button>
    <button id="reset-cd">Reset</button>
  </div>
</div>

<script>
/* ---------- 1️⃣ EST Clock ---------- */
const estEl = document.getElementById('time-est');
function updateEST(){
  const now = new Date();
  const est = new Intl.DateTimeFormat('en-US', {
    hour:'2-digit', minute:'2-digit', second:'2-digit',
    hour12:false, timeZone:'America/New_York'
  }).format(now);
  estEl.textContent = est;
}
setInterval(updateEST, 1000);
updateEST();

/* ---------- 2️⃣ Custom Clock 1 & 2 ---------- */
const customClocks = [
  {offsetInput:'offset-c1', setBtn:'set-c1', timeEl:'time-c1', displayEl:'clock-c1'},
  {offsetInput:'offset-c2', setBtn:'set-c2', timeEl:'time-c2', displayEl:'clock-c2'}
];
customClocks.forEach(cfg=>{
  const offsetEl = document.getElementById(cfg.offsetInput);
  const btn = document.getElementById(cfg.setBtn);
  const timeEl = document.getElementById(cfg.timeEl);
  let minutesOffset = null;        // minutes from UTC
  let interval = null;

  function setOffset(){
    const val = offsetEl.value.trim();
    if(!val) return alert('Enter a GMT offset (e.g. +5.5, -3)');
    const m = parseOffset(val);
    if(m===null) return alert('Invalid offset. Use +5.5 or -8');
    minutesOffset = m;
    if(interval) clearInterval(interval);
    interval = setInterval(updateCustom, 1000);
    updateCustom();
  }

  function updateCustom(){
    const utcNow = new Date();
    const localMs = utcNow.getTime() + minutesOffset*60*1000;
    const local = new Date(localMs);
    const hh = pad(local.getUTCHours());
    const mm = pad(local.getUTCMinutes());
    const ss = pad(local.getUTCSeconds());
    timeEl.textContent = `${hh}:${mm}:${ss}`;
  }

  btn.addEventListener('click', setOffset);
});

/* Parse strings like "+5.5" or "-3" to minutes (null on failure) */
function parseOffset(str){
  const m = str.match(/^([+-]?)(\d+)(?:\.(\d+))?$/);
  if(!m) return null;
  let sign = m[1]==='-'? -1 : 1;
  let hours = parseInt(m[2],10);
  let minutes = m[3] ? Math.round(parseInt(m[3],10)* (m[3].length===1? 6 : 10)) : 0; // e.g. .5 -> 30
  // if fraction is like .25 we treat 25*6 = 150? better: treat fraction as decimal fraction of hour
  if(m[3] && m[3].length===1) { minutes = Math.round(parseInt(m[3],10)*60); }
  return sign*(hours*60 + minutes);
}

/* Helper to pad numbers */
function pad(n){return n.toString().padStart(2,'0');}

/* ---------- 3️⃣ Countdown Timer ---------- */
const targetInput = document.getElementById('target-dt');
const remainingEl = document.getElementById('time-remaining');
let countdownInterval = null;
let targetTime = null;

function startCountdown(){
  if(!targetTime) return;
  clearInterval(countdownInterval);
  countdownInterval = setInterval(tickCountdown, 1000);
  tickCountdown();
}
function resetCountdown(){
  clearInterval(countdownInterval);
  remainingEl.textContent = '--:--:--';
  targetTime = null;
  targetInput.value = '';
}

function tickCountdown(){
  if(!targetTime) return;
  const now = new Date();
  let diff = targetTime - now;
  if(diff <= 0){
    remainingEl.textContent = '00:00:00';
    clearInterval(countdownInterval);
    return;
  }
  const h = Math.floor(diff/(3600*1000));
  const m = Math.floor((diff%(3600*1000))/(60*1000));
  const s = Math.floor((diff%(60*1000))/1000);
  remainingEl.textContent = `${pad(h)}:${pad(m)}:${pad(s)}`;
}

document.getElementById('start-cd').addEventListener('click',()=>{
  const dt = targetInput.value;
  if(!dt) return alert('Please choose a target date/time.');
  targetTime = new Date(dt);
  if(isNaN(targetTime)) return alert('Invalid date/time.');
  startCountdown();
});

document.getElementById('reset-cd').addEventListener('click', resetCountdown);



</script>

<h2>Note: The clocks above will function correctly only if the workstation’s clock is set to Zulu (UTC) time.</h2>
</body>
</html>
