<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>CSO Clocks</title>
<style>
  :root{
    --body-font:Arial,Helvetica,sans-serif;
    --bg:#f4f4f4;
    --card:#fff;
    --shadow:0 1px 3px rgba(0,0,0,.15);
    --radius:6px;
    --padding:12px;
    --margin:20px;
    --btn-bg:#2d89ef;
    --btn-hover:#1b5fbd;
    --btn-radius:4px;
  }
  body{
    font-family:var(--body-font);
    margin:var(--margin);
    background:var(--bg);
  }
  h1{font-size:1.8rem;margin:0 0 1.5rem}
  h2{margin:12px 0 6px}
  .clock{
    background:var(--card);
    border-radius:var(--radius);
    padding:var(--padding);
    margin-bottom:1rem;
    box-shadow:var(--shadow);
  }
  .clock h3{margin:0 0 4px;font-size:1.1rem}
  .time{font-size:1.6rem;font-weight:600}
  .controls{margin-top:.5rem}
  input[type="number"],input[type="text"],input[type="datetime-local"]{
    padding:.4rem .6rem;font-size:.9rem;margin-right:.6rem;width:140px}
  button{
    padding:.5rem 1rem;font-size:.9rem;
    background:var(--btn-bg);color:#fff;border:none;
    border-radius:var(--btn-radius)
  }
  button:hover{background:var(--btn-hover)}

  /* Mobile layout – stack the clocks */
  @media (max-width:480px){
    body{margin:1rem}
    input[type="number"],input[type="text"],input[type="datetime-local"]{
      width:calc(100% - 1rem);
      margin-bottom:.5rem
    }
    button{width:100%;margin-bottom:.5rem}
    .controls{display:flex;flex-direction:column}
  }
</style>
</head>
<body>

<h1>CSO Clocks</h1>

<!-- 1️⃣ EST Clock -->
<div class="clock" id="clock-est">
  <h3>Washington D.C.</h3>
  <div class="time" id="time-est">--:--:--</div>
</div>

<!-- 2️⃣ Custom Clock 1 -->
<div class="clock" id="clock-c1">
  <h3>Origin Time</h3>
  <div class="time" id="time-c1">--:--:--</div>
  <div class="controls">
    <input type="number" id="offset-c1-h" placeholder="±hh" min="-12" max="14" step="1">
    <input type="number" id="offset-c1-m" placeholder="mm" min="0" max="59" step="1">
    <button id="set-c1">Set</button>
  </div>
</div>

<!-- 3️⃣ Custom Clock 2 -->
<div class="clock" id="clock-c2">
  <h3>Destination Time</h3>
  <div class="time" id="time-c2">--:--:--</div>
  <div class="controls">
    <input type="number" id="offset-c2-h" placeholder="±hh" min="-12" max="14" step="1">
    <input type="number" id="offset-c2-m" placeholder="mm" min="0" max="59" step="1">
    <button id="set-c2">Set</button>
  </div>
</div>

<!-- 4️⃣ Countdown -->
<div class="clock" id="countdown">
  <h3>ETA (Zulu)</h3>
  <div class="time" id="time-remaining">--:--:--</div>
  <div class="controls">
    <input type="datetime-local" id="target-dt">
    <button id="start-cd">Start</button>
    <button id="reset-cd">Reset</button>
  </div>
</div>

<script>
/* ---------- 1️⃣ EST Clock ---------- */
const estEl = document.getElementById('time-est');
function updateEST(){
  const now = new Date();
  const est = new Intl.DateTimeFormat('en-US', {
    hour:'2-digit', minute:'2-digit', second:'2-digit',
    hour12:false, timeZone:'America/New_York'
  }).format(now);
  estEl.textContent = est;
}
setInterval(updateEST, 1000);
updateEST();

/* ---------- 2️⃣ Custom Clock 1 & 2 ---------- */
const customClocks = [
  {hoursInput:'offset-c1-h', minsInput:'offset-c1-m', setBtn:'set-c1', timeEl:'time-c1'},
  {hoursInput:'offset-c2-h', minsInput:'offset-c2-m', setBtn:'set-c2', timeEl:'time-c2'}
];
customClocks.forEach(cfg=>{
  const hEl = document.getElementById(cfg.hoursInput);
  const mEl = document.getElementById(cfg.minsInput);
  const btn = document.getElementById(cfg.setBtn);
  const timeEl = document.getElementById(cfg.timeEl);
  let minutesOffset = null;
  let interval = null;

  function setOffset(){
    const hVal = hEl.value.trim();
    const mVal = mEl.value.trim();

    if(hVal==='') return alert('Enter hour offset (±hh).');
    if(mVal==='') return alert('Enter minutes offset (0‑59).');

    const h = parseInt(hVal,10);
    const m = parseInt(mVal,10);
    if(isNaN(h) || isNaN(m) || m>59 || m<0)
      return alert('Hour must be ±12‑14, minutes 0‑59.');

    const sign = hVal[0]==='-' ? -1 : 1;
    minutesOffset = sign*(Math.abs(h)*60 + m);
    if(interval) clearInterval(interval);
    interval = setInterval(updateCustom, 1000);
    updateCustom();
  }

  function updateCustom(){
    const utcNow = new Date();
    const localMs = utcNow.getTime() + minutesOffset*60*1000;
    const local = new Date(localMs);
    const hh = pad(local.getUTCHours());
    const mm = pad(local.getUTCMinutes());
    const ss = pad(local.getUTCSeconds());
    timeEl.textContent = `${hh}:${mm}:${ss}`;
  }

  btn.addEventListener('click', setOffset);
});

/* Helper to pad numbers */
function pad(n){return n.toString().padStart(2,'0');}

/* ---------- 3️⃣ Countdown Timer ---------- */
const targetInput = document.getElementById('target-dt');
const remainingEl = document.getElementById('time-remaining');
let countdownInterval = null;
let targetTime = null;

function startCountdown(){
  if(!targetTime) return;
  clearInterval(countdownInterval);
  countdownInterval = setInterval(tickCountdown, 1000);
  tickCountdown();
}
function resetCountdown(){
  clearInterval(countdownInterval);
  remainingEl.textContent = '--:--:--';
  targetTime = null;
  targetInput.value = '';
}

function tickCountdown(){
  if(!targetTime) return;
  const now = new Date();
  const diff = targetTime - now;
  if(diff<=0){
    clearInterval(countdownInterval);
    remainingEl.textContent = '00:00:00';
    return;
  }
  const d = new Date(diff);
  const hh = pad(d.getUTCHours());
  const mm = pad(d.getUTCMinutes());
  const ss = pad(d.getUTCSeconds());
  remainingEl.textContent = `${hh}:${mm}:${ss}`;
}

document.getElementById('start-cd').addEventListener('click', ()=>{
  const val = targetInput.value;
  if(!val) return alert('Choose a future date/time.');
  targetTime = new Date(val);
  if(targetTime < new Date()) return alert('Time must be in the future.');
  startCountdown();
});
document.getElementById('reset-cd').addEventListener('click', resetCountdown);
</script>

<p style="font-size:.8rem;color:#555">
  <strong>Note:</strong> The ETA clock uses the Workstations system clock. It will only function properly if the Workstation is set to Zulu.</p>
</body>
</html>
